# Critical Path & 거시금융 분석 시스템 설계 문서

> **Market Intelligence System v3.0 - 개념 설계 및 논의 정리**
>
> 작성일: 2024-12-29
> 상태: 개념 설계 단계 (코드 구현 전)

---

## 목차

1. [프로젝트 철학](#1-프로젝트-철학)
2. [초기 설계와 발견된 결함](#2-초기-설계와-발견된-결함)
3. [ETF 자금 흐름 분석](#3-etf-자금-흐름-분석)
4. [예측 정확도 문제 해결](#4-예측-정확도-문제-해결)
5. [이벤트 기반 분석 (Structural Break)](#5-이벤트-기반-분석-structural-break)
6. [파생상품 및 새로운 자산군](#6-파생상품-및-새로운-자산군)
7. [통합 선행지표 프레임워크](#7-통합-선행지표-프레임워크)
8. [데이터 소스 계획](#8-데이터-소스-계획)
9. [미해결 질문 및 향후 과제](#9-미해결-질문-및-향후-과제)
10. [구현 로드맵](#10-구현-로드맵)

---

## 1. 프로젝트 철학

### 1.1 핵심 원칙

경제학 지침 문서의 핵심 메시지:

> **"AI(데이터)는 현상을 보여주지만, 경제학은 그 이유(Why)를 설명한다"**

이 프로젝트는 단순한 상관관계 분석이 아닌, **경제학적 인과관계(Causality)**를 기반으로 한 시장 분석 시스템을 목표로 한다.

### 1.2 Blackbox → Whitebox 전환

```
┌─────────────────────────────────────────────────────────────────┐
│                    분석 패러다임 전환                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  기존 접근 (Blackbox):                                           │
│  • ML 모델이 패턴 발견                                           │
│  • "왜" 그런지 설명 불가                                         │
│  • 정책/투자 의사결정에 부적합                                   │
│                                                                  │
│  목표 접근 (Whitebox):                                           │
│  • 경제학적 인과관계 기반 설계                                   │
│  • 온톨로지(노드/엣지)로 관계 명시화                             │
│  • "왜" 시장이 움직이는지 설명 가능                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 1.3 핵심 질문

| 질문 | 설명 | 경제학적 도구 |
|------|------|--------------|
| **What leads what?** | 어떤 변수가 다른 변수를 선행하는가? | Granger Causality, VAR |
| **Why does it lead?** | 경제학적으로 왜 그 선행관계가 성립하는가? | 이론적 프레임워크 |
| **How long is the lag?** | 시차(Lead Time)는 얼마나 되는가? | Impulse Response Function |
| **When does it break?** | 어떤 조건에서 이 관계가 무너지는가? | Regime Switching |

---

## 2. 초기 설계와 발견된 결함

### 2.1 초기 Critical Path 계층 구조

```
Layer 1: 유동성/신용 (가장 선행)
├── HY Spread (Path 3) → 부도 사이클 예측
├── Bank Stocks (Path 10) → 신용 가용성
└── EM Flows (Path 8) → 글로벌 유동성
        │
        ▼ (2-6개월 선행)
        
Layer 2: 실물경제 신호
├── Yield Curve (Path 1) → 경기침체 예측
├── Copper/Gold (Path 2) → 산업 활동
└── Sector Rotation (Path 5) → 경기 사이클 위치
        │
        ▼ (1-3개월 선행)
        
Layer 3: 리스크 센티먼트
├── VIX Structure (Path 7) → 변동성 체제
├── Dollar Smile (Path 4) → 글로벌 리스크
└── Breakevens (Path 6) → 인플레 기대
        │
        ▼ (동시~수주 선행)
        
Layer 4: 가격 (후행, 결과)
└── S&P 500, NASDAQ 등 대형주 지수
```

### 2.2 발견된 결함

#### 결함 1: 피드백 루프 무시

```
문제:
일방향 전파 가정 (Layer 1 → 2 → 3 → 4)

현실:
양방향 피드백 존재
• 주가 폭락 → 소비자 심리 위축 → 실물경제 악화 → 신용 악화
• "Financial Accelerator" 효과

보완 방향:
• 단방향 경로 대신 방향성 그래프(DAG) 또는 순환 그래프로 재설계
• 피드백 강도와 시차를 별도로 모델링
```

#### 결함 2: 동시성(Simultaneity) 문제

```
문제:
HY Spread ↑ → 주가 ↓ (선행관계?)
아니면 둘 다 "제3의 변수"에 동시 반응?

제3의 변수 후보:
• Fed 정책 기대 변화
• 지정학적 리스크
• 글로벌 유동성 사이클

보완 방향:
• 구조적 VAR(SVAR) 또는 도구변수(IV) 접근
• Treasury 변수 제외 (LASSO 방법론 차용)
• Granger Causality의 한계 인정
```

#### 결함 3: Regime 의존성 누락

```
문제:
Lead Time(예: HY Spread → 주가, 2-3분기)은 "평균적" 관계
Regime에 따라 관계가 완전히 달라짐

Regime별 차이:
┌─────────────┬────────────────────────────────────┐
│ Regime      │ 특성                               │
├─────────────┼────────────────────────────────────┤
│ Normal      │ 선행-후행 관계 정상 작동           │
│ Crisis      │ 모든 자산 동시 움직임 (상관→1)     │
│ Bubble      │ 전통적 밸류에이션 신호 무시됨      │
└─────────────┴────────────────────────────────────┘

치명적 문제:
• 위기 상황에서 Critical Path가 가장 필요
• 바로 그때 관계가 무너짐

보완 방향:
• Regime을 상태 변수로 두고 조건부 분석
• Markov Switching 모델로 Regime 전환 감지
• Regime별 다른 경로 가중치 적용
```

#### 결함 4: 비선형성과 임계점 누락

```
문제:
선형 관계 암묵적 가정
HY Spread +100bp → 주가 -X%
HY Spread +200bp → 주가 -2X% (비례적?)

현실:
비선형, 임계점 존재
HY Spread +500bp → 시스템 붕괴 (비선형 폭발)

임계점 예시:
• VIX 30 이하: 정상 작동
• VIX 30-40: 경계 구간
• VIX 40 이상: 관계 붕괴, 모든 것이 유동성에만 반응

보완 방향:
• 임계점 기반 규칙을 별도 레이어로 추가
• 비선형 모델 (Tree-based, 구간별 회귀)
```

#### 결함 5: 정책 반응 함수 누락

```
문제:
시장 변수만 다루고 정책 입안자의 반응 무시

누락된 피드백:
시장 붕괴 조짐 → Fed 개입 → 위기 완화 → 선행지표 "오보"

실제 사례 (2018년 12월):
• 모든 선행지표가 경고 신호
• Fed가 "Powell Pivot" (정책 전환)
• 위기 없이 V자 반등
• 선행지표를 믿고 매도한 사람들 손실

보완 방향:
• Fed Watch, 정책 기대 변수 통합
• 정책 반응 임계점 모니터링
```

#### 결함 6: 거래량 노이즈 문제

```
경제학 지침 주장:
"이상 거래량 = 사적 정보 유입"

현실 (거래량 급증의 실제 원인):
1. 정보 거래 (Informed Trading) ← 찾고 싶은 것
2. 유동성 거래 (Liquidity Trading) ← 노이즈
3. 알고리즘/HFT ← 구조적 노이즈 (60-70%)
4. 지수 리밸런싱 ← 정보 없음
5. 옵션 만기 헤징 ← 기술적 요인

보완 방향:
• 거래량 대신 "자금 흐름"으로 전환
• ETF Flow 분석
• 정보 거래 vs 노이즈 분리 방법론 필요
```

### 2.3 결함 우선순위

| 순위 | 결함 | 심각도 | 보완 난이도 |
|------|------|--------|------------|
| 1 | 피드백 루프 무시 | 높음 | 중간 |
| 2 | Regime 의존성 누락 | 높음 | 높음 |
| 3 | 동시성 문제 | 높음 | 높음 |
| 4 | 비선형성/임계점 | 중간 | 중간 |
| 5 | 정책 반응 함수 | 중간 | 높음 |
| 6 | 거래량 노이즈 | 중간 | 중간 |

---

## 3. ETF 자금 흐름 분석

### 3.1 거래량 → 자금 흐름 전환

```
거래량의 문제:
거래량 = 매수 + 매도 (방향성 없음)
       + 알고리즘 노이즈
       + 옵션 헤징
       → "정보"가 희석됨

ETF Flow의 장점:
비중 변화 = 시가총액 변화 + 자금 유입/유출
          = 실제 "베팅"의 방향성을 반영
          → 노이즈가 적음
```

### 3.2 ETF 유형별 신호 해석

| ETF 유형 | 신호 특성 | 선행성 |
|----------|----------|--------|
| 시가총액 가중 (SPY, QQQ) | 비중 변화 = 가격 변화의 결과 | 후행 |
| 동일 가중 (RSP, QQQE) | 동일가중 vs 시총가중 성과 차이가 신호 | 동시 |
| Active/Thematic (ARKK, SOXL) | 펀드 매니저의 의도적 베팅 | 잠재적 선행 |
| ETF Flow (유입/유출) | 투자자들의 집단적 판단 | 가장 유망 |

### 3.3 Cross-Sectional Flow 분석

```
비교 1: 성장 vs 가치
• VUG (Vanguard Growth) Flow
• VTV (Vanguard Value) Flow
• 비율 변화 = 스타일 로테이션 신호

비교 2: 대형 vs 소형
• SPY Flow
• IWM Flow
• IWM 대비 SPY 유입 가속 = 방어적 전환

비교 3: 미국 vs 글로벌
• SPY Flow
• EFA (선진국) / EEM (신흥국) Flow
• 달러 강세/약세 전망과 연결

비교 4: 주식 vs 채권
• SPY Flow
• AGG (종합채권) Flow
• 자산 배분 변화의 가장 큰 그림

비교 5: Risk-On vs Risk-Off
• HYG (하이일드) Flow
• TLT (장기채) Flow
• GLD (금) Flow
• 리스크 선호도 변화
```

### 3.4 모델 포트폴리오 리밸런싱 감지

```
중요 인사이트:
• 대형 모델 포트폴리오 (BlackRock 등) 리밸런싱 시 대규모 Flow 발생
• 예: QUAL에 2일간 $7B 유입 (2023년 3월, BlackRock 모델 포트폴리오 변경)

모니터링 방법:
• 특정 ETF에 갑작스런 대규모 유입/유출
• 정기 리밸런싱 시점 (월말, 분기말) 전후
• 비정상적 Flow 탐지
```

### 3.5 데이터 소스

| 소스 | 비용 | 갱신 주기 | 특징 |
|------|------|----------|------|
| etf.com | 무료 | 일간 | 기본 Flow 데이터 |
| etfdb.com | 무료 | 일간 | 섹터별 분류 우수 |
| Bigdata.com ETF Flows | 유료 | 일간 | 2016년~ 히스토리 |
| Bloomberg Terminal | $32,000/년 | 실시간 | 종합 데이터 |
| EPFR Global | 기관용 | 주간 | 글로벌 펀드 플로우 |

---

## 4. 예측 정확도 문제 해결

### 4.1 클래스 불균형 문제

```
실제 시장 데이터 (예시):
• 상승일: 55%
• 하락일: 45%

"바보 모델" 전략:
• 항상 "상승" 예측
• 정확도: 55%
• 실제 가치: 0 (예측이 아님)

핵심 질문:
우리 모델이 정확도 58%를 달성했다면...
• 진짜 실력인가?
• 아니면 상승 편향에 기댄 것인가?
```

### 4.2 질문의 재정의

```
기존 질문 (문제 있음):
"내일 시장이 오를까, 내릴까?"
→ 일상적 변동은 본질적으로 노이즈

더 나은 질문들:
┌─────────────────────────────────────────────────────────────────┐
│ 질문 유형                │ 가치        │ 활용                    │
├─────────────────────────────────────────────────────────────────┤
│ Regime 전환 예측         │ 매우 높음   │ 자산 배분 전략          │
│ "Bull→Bear 전환 시점?"   │ (연 1-2회)  │                         │
├─────────────────────────────────────────────────────────────────┤
│ Tail Risk 예측           │ 높음        │ 리스크 관리             │
│ "1개월 내 5% 이상 하락?" │             │ 옵션 헤징               │
├─────────────────────────────────────────────────────────────────┤
│ 변동성 Regime 예측       │ 높음        │ 옵션 전략               │
│ "저변동성→고변동성 전환?"│             │ 변동성 매매             │
├─────────────────────────────────────────────────────────────────┤
│ 상대 성과 예측           │ 중간        │ 자산 배분               │
│ "주식 vs 채권?"          │             │ 섹터 로테이션           │
└─────────────────────────────────────────────────────────────────┘
```

### 4.3 대안 평가 메트릭

```
1. 클래스별 분리 평가
   • 상승 예측 Precision: 상승 예측 중 실제 상승 비율
   • 하락 예측 Precision: 하락 예측 중 실제 하락 비율
   • 특히 "하락 예측 Precision"이 핵심 (손실 회피)

2. 경제적 가치 기반 메트릭
   • Hit Rate vs Win/Loss Ratio
   • Sharpe Ratio: 예측 기반 전략의 위험 조정 수익
   • Max Drawdown: 최대 손실폭

3. 조건부 정확도
   • "모델이 확신할 때"만의 정확도
   • 확률 70% 이상으로 예측했을 때의 성과
   • 모호한 예측(50-55%)은 "예측 없음"으로 처리

4. 비대칭 손실 함수
   • 하락을 상승으로 잘못 예측: 손실 발생 (심각)
   • 상승을 하락으로 잘못 예측: 기회비용 (덜 심각)
```

### 4.4 3-Class 접근법

```
2-Class의 한계:
상승 vs 하락
→ +0.01% 상승도 "상승", -0.01% 하락도 "하락"
→ 본질적으로 노이즈

3-Class 접근:
• 의미 있는 상승 (>+1%)
• 보합 (-1% ~ +1%)
• 의미 있는 하락 (<-1%)

장점:
• "보합"을 예측할 때는 액션 불필요
• 노이즈 구간 제거
• 의미 있는 움직임에만 집중

임계값 설정 고려사항:
• 고정값 vs 변동성 기반 동적 임계값
• 자산별 다른 임계값
• 백테스팅 과적합 위험
```

### 4.5 확률 임계값 기반 거래

```
"예측 확률이 65% 이상일 때만 거래"

예시:
• 모델 출력: 상승 확률 52% → 거래 안 함
• 모델 출력: 상승 확률 72% → 매수
• 모델 출력: 하락 확률 68% → 매도

효과:
• 거래 빈도 ↓
• 확신 있는 예측만 실행
• 실질적인 Edge에 집중

예측 불확실성 자체의 가치:
• 모델이 예측하기 어려운 시점 = 시장 자체가 불확실
• "예측 불확실성"이 유용한 정보가 될 수 있음
```

---

## 5. 이벤트 기반 분석 (Structural Break)

### 5.1 전통적 백테스팅의 문제

```
전통적 백테스팅:
2020-01-01 ~ 2024-12-31 (5년)
    │
    │  전체 기간을 하나로 취급
    │
    └── 문제: 시장 구조가 중간에 바뀌었음

현실 (2020-2024):
• 2020-01: COVID 이전 시장
• 2020-03: COVID 폭락
• 2020-04~2021: 양적완화 버블
• 2022: 금리 인상 충격
• 2022-11: ChatGPT 출시 ← Structural Break
• 2023~: AI 붐

각 구간이 완전히 다른 시장 → 같은 모델이 작동할 리 없음
```

### 5.2 구조적 변화(Structural Break) 유형

| Type | 설명 | 예시 |
|------|------|------|
| 정책 변화 | Fed 금리 사이클, 양적완화/긴축 | 2022 금리 인상 시작 |
| 기술 패러다임 전환 | 새로운 기술이 시장 구조 변경 | ChatGPT, iPhone |
| 기업 특정 이벤트 | M&A, 파트너십, 경영진 교체 | Reddit-OpenAI, 삼성-테슬라 |
| 거시 충격 | 팬데믹, 금융위기, 지정학 | COVID-19, 2008 |

### 5.3 이벤트 기반 백테스팅 프레임워크

```
┌─────────────────────────────────────────────────────────────────┐
│              Event-Driven Backtesting Framework                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Step 1: 구조적 변화 이벤트 식별                                 │
│  • 수동 태깅: 알려진 중요 이벤트 목록화                          │
│  • 자동 탐지: Chow Test, CUSUM 등 통계적 검정                    │
│  • 뉴스 기반: 특정 키워드 급등 탐지 (NLP)                        │
│                                                                  │
│  Step 2: 이벤트 전후 구분                                        │
│                                                                  │
│      ◄── Pre-Event ──►│◄── Post-Event ──────────────►           │
│                       │                                          │
│     이 데이터는       │   이 데이터만                            │
│     더 이상 유효하지  │   학습/검증에 사용                       │
│     않을 수 있음      │                                          │
│                       │                                          │
│                  이벤트 발생                                     │
│                                                                  │
│  Step 3: 이벤트 유형별 분석                                      │
│  • 이벤트 직후 (0~5일): 시장 반응 측정                           │
│  • 안정화 기간 (5~20일): 새로운 균형점 탐색                      │
│  • 새 Regime (20일~): 새로운 패턴 학습 시작                      │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.4 Structural Break 자동 탐지 방법

```
1. 통계적 방법
   • Chow Test: 특정 시점 전후로 회귀계수 변화 검정
   • CUSUM Test: 누적합 기반 변화점 탐지
   • Bai-Perron Test: 다중 구조변화점 탐지

2. 변동성 기반
   • 실현 변동성 급등
   • VIX Term Structure 역전
   • 거래량 이상 급증

3. 상관관계 변화
   • 섹터 간 상관관계 급변
   • 자산 간 상관관계 붕괴/급등
   • 예: 주식-채권 상관관계 양(+)으로 전환

4. 뉴스/이벤트 기반 (NLP)
   • 특정 기업/섹터 관련 뉴스 볼륨 급증
   • 감성 분석 점수 급변
   • 특정 키워드 빈도 변화 (예: "AI", "partnership")
```

### 5.5 적용 예시: ChatGPT 출시

```
ChatGPT 출시 (2022-11-30)

Before (학습에서 제외하거나 별도 처리):
• 엔비디아: 게이밍/데이터센터 GPU 회사
• 마이크로소프트: 클라우드/오피스 회사
• 반도체 섹터: 사이클리컬, PC 수요 연동

After (새로운 학습 기간):
• 엔비디아: AI 인프라 독점 기업
• 마이크로소프트: AI 플랫폼 회사
• 반도체 섹터: AI Capex와 연동

만약 Before 데이터로 학습하면?
• "엔비디아는 PC 판매량과 상관관계가 높다"
• → 완전히 틀린 모델이 됨
```

---

## 6. 파생상품 및 새로운 자산군

### 6.1 핵심 논리: "손해보는 상품은 만들지 않는다"

```
금융 상품 생태계의 정보 계층:

Tier 1: 상품 설계자 (Investment Banks, Issuers)
• 가장 먼저 시장 수요/공급 파악
• 리스크 프라이싱 능력 보유
• 자기 자본 리스크를 걸고 상품 출시
→ "우리가 돈 벌 수 있다고 판단했을 때만 출시"
        │
        ▼
Tier 2: 기관 투자자 (Hedge Funds, Asset Managers)
• 상품 출시 직후 초기 매수/매도
• 독자적 리서치 역량
• 13F로 45일 후 공개
        │
        ▼
Tier 3: 개인 투자자 (Retail)
• 상품이 "인기"를 얻은 후 진입
• 뉴스/미디어를 통해 정보 획득
• 종종 고점 매수
```

### 6.2 상품 설계자 행동에서 읽는 신호

| 신호 | 의미 | 주의점 |
|------|------|--------|
| 새로운 ETF 출시 급증 | 해당 테마에 대한 확신 | 너무 많으면 후기 사이클 |
| ETF 청산/합병 | 테마의 죽음 또는 바닥 | 역설적 contrarian 기회? |
| 파생상품 구조 변화 | 시장 수요 변화 반영 | 복잡한 해석 필요 |
| 회사채 발행 조건 변화 | 신용 시장 상태 | 발행자+인수자 판단 |

### 6.3 옵션 시장 선행 지표

```
1. Put/Call Ratio
   • 높음 = 하락 베팅 증가 (공포)
   • 극단적으로 높음 = 역발상 매수 신호?
   • BUT 단순 비율은 노이즈 많음

2. Skew (스큐)
   • OTM Put vs OTM Call의 IV 차이
   • Skew 급등 = 꼬리 위험 인식 증가
   • "보험료"가 비싸지고 있다는 신호

3. Term Structure (기간 구조)
   • 단기 IV > 장기 IV = Backwardation
   • 즉각적인 위험 인식
   • VIX vs VIX3M 비율로 측정

4. Unusual Options Activity
   • 평소 대비 10x 이상 거래량
   • 특히 OTM 옵션 대량 매수
   • "누군가 뭔가 알고 있다" 신호

5. Gamma Exposure (GEX)
   • 시장 전체의 감마 노출
   • 양(+) GEX = 딜러 헤징이 변동성 억제
   • 음(-) GEX = 딜러 헤징이 변동성 증폭
```

### 6.4 신용 파생상품 선행 지표

```
1. CDS Spread (Credit Default Swap)
   • 부도 보험료 = 가장 직접적인 신용 위험 지표
   • 주가보다 선행하는 경향
   • 예: 2008년 리먼 CDS → 주가 폭락 전 급등

2. 금리 스왑 스프레드
   • Swap Rate - Treasury Rate
   • 은행 시스템 스트레스 지표

3. 회사채 신규 발행 조건
   • 발행 금리 스프레드 변화
   • 발행 규모/빈도 변화
   • Covenant (약정) 조건 강화/완화
```

### 6.5 암호화폐의 위치

```
새로운 M = M₀ × m + 파생자산 + 스테이블코인 + 신용 창출

암호화폐의 선행지표 특성:

1. 24/7 거래
   • 주말/공휴일에도 거래
   • 전통 시장 개장 전 리스크 선호도 확인 가능
   • 일요일 밤 BTC 급락 → 월요일 주식 시장 약세?

2. 글로벌 유동성의 프록시
   • 규제가 적어 자본 이동이 자유로움
   • 글로벌 유동성 축소 시 가장 먼저 반응
   • "Canary in the coal mine"

3. 리스크 선호도의 극단
   • 가장 투기적인 자산
   • Risk-on의 끝단에 위치

4. 버블 붕괴 순서
   밈코인 → 중소형 알트 → 대형 알트 → ETH → BTC
   (주식의 ARKK → IWM → SPY 순서와 유사)
```

### 6.6 스테이블코인 신호

| 신호 | 의미 |
|------|------|
| 스테이블코인 시총 증가 | 새로운 자금 유입, "대기 자금" 축적 |
| 스테이블코인 시총 감소 | 자금 이탈 또는 이미 투자에 사용 |
| USDT vs USDC 비율 변화 | 해외 vs 미국 자금 출처 변화 |
| 디페깅(Depeg) 이벤트 | 극단적 스트레스 신호 |

### 6.7 Cross-Asset 상관관계 모니터링

```
핵심 모니터링:
1. 주식-채권 상관: 음(-)에서 양(+)으로 전환 시 위험
2. BTC-주식 상관: 높아지면 "리스크 자산" 취급 강화
3. 금-BTC 상관: "디지털 금" 내러티브 유효성
4. 달러-BTC 상관: 달러 약세 시 BTC 강세 패턴

상관관계 Regime:

Normal 시장:
• 자산 간 상관관계 안정적
• 분산 투자 효과 존재

Stress 시장:
• 상관관계 → 1로 수렴
• 분산 투자 무력화

Bubble 시장:
• 특정 자산군만 디커플링
• 나머지 자산과 괴리 = 버블 신호
```

---

## 7. 통합 선행지표 프레임워크

### 7.1 5-Tier 구조

```
┌─────────────────────────────────────────────────────────────────┐
│              Multi-Asset Leading Indicator Framework             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  TIER 1: 상품 설계자 행동 (가장 선행)                            │
│  ─────────────────────────────────                               │
│  • 새로운 ETF/ETP 출시 패턴                                      │
│  • 파생상품 구조 변화                                            │
│  • 회사채 발행 조건 변화                                         │
│  • 스테이블코인 신규 발행량                                      │
│  → "돈을 거는 사람들"의 판단                                     │
│                                                                  │
│  TIER 2: 파생상품 가격 신호                                      │
│  ─────────────────────────────────                               │
│  • VIX Term Structure                                            │
│  • 옵션 Skew / Gamma Exposure                                    │
│  • CDS Spread                                                    │
│  • 암호화폐 선물 베이시스                                        │
│  → "보험료"와 "레버리지 비용"의 변화                             │
│                                                                  │
│  TIER 3: 자금 흐름                                               │
│  ─────────────────────────────────                               │
│  • ETF Flow (섹터별, 스타일별)                                   │
│  • 스테이블코인 시총 변화                                        │
│  • 거래소 BTC/ETH 잔고 변화                                      │
│  → "돈이 실제로 어디로 가는가"                                   │
│                                                                  │
│  TIER 4: 상관관계 변화                                           │
│  ─────────────────────────────────                               │
│  • Cross-asset correlation regime                                │
│  • 암호화폐-주식 상관 변화                                       │
│  • 채권-주식 상관 전환                                           │
│  → "시장 구조"의 변화                                            │
│                                                                  │
│  TIER 5: 가격 (가장 후행)                                        │
│  ─────────────────────────────────                               │
│  • S&P 500, NASDAQ                                               │
│  • BTC, ETH                                                      │
│  → 이미 모든 정보가 반영된 결과                                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 7.2 ETF Flow + 이벤트 분석 통합

```
Layer 1: 이벤트 탐지 (Structural Break Detection)
• 통계적 검정으로 구조 변화 시점 식별
• 뉴스 볼륨/감성 급변 탐지
• 변동성 regime 전환 감지
        │
        ▼
Layer 2: 이벤트 검증 (ETF Flow Confirmation)
• 이벤트 발생 후 ETF Flow 패턴 변화 확인
• "돈이 실제로 움직였는가?"
• 예: ChatGPT 후 AI ETF Flow 급증 확인
        │
        ▼
Layer 3: 새 Regime 정의
• 이벤트 이후 기간만을 "유효 데이터"로 설정
• 새로운 상관관계/패턴 학습
• 이전 모델과 비교하여 변화 정도 측정
        │
        ▼
Layer 4: 조건부 예측
• 현재 Regime에 맞는 모델로 예측
• 다음 Structural Break 조기 경보
• ETF Flow 변화가 새로운 이벤트 신호인지 모니터링
```

---

## 8. 데이터 소스 계획

### 8.1 무료 / 저비용 (시작점)

| 소스 | 데이터 | 갱신 주기 | API |
|------|--------|----------|-----|
| etf.com / etfdb.com | ETF Flow | 일간 | 제한적 |
| FRED | 거시 지표, 금리, 스프레드 | 다양 | ✓ |
| Yahoo Finance (yfinance) | 가격, 거래량 | 실시간 | ✓ |
| CoinGecko / CoinMarketCap | 암호화폐 가격, 시총 | 실시간 | ✓ |
| Glassnode (무료 tier) | 온체인 기본 지표 | 일간 | ✓ |
| CBOE | VIX, VIX3M, Skew Index | 일간 | 제한적 |

### 8.2 유료 / 고급 (확장 시)

| 소스 | 데이터 | 비용 |
|------|--------|------|
| Bloomberg / Refinitiv | 종합 데이터 | $32,000+/년 |
| EPFR | 펀드 플로우 | 기관용 |
| Glassnode (유료) | 상세 온체인 | 구독 |
| Unusual Whales / FlowAlgo | 옵션 플로우 | 구독 |
| Santiment | 암호화폐 소셜/온체인 | 구독 |
| Nasdaq Data Link | 13F/ETF 데이터 | 구독 |

### 8.3 API 기반 자동화 가능

```python
# 무료 API 예시
import yfinance as yf
from fredapi import Fred
# CoinGecko API

# 유료 API
# Nasdaq Data Link (Quandl)
# Bloomberg API
```

---

## 9. 미해결 질문 및 향후 과제

### 9.1 이론적 질문

| 질문 | 중요도 | 난이도 |
|------|--------|--------|
| 피드백 루프를 어떻게 모델에 반영할 것인가? | 높음 | 높음 |
| Regime 전환 자체를 어떻게 미리 감지할 것인가? | 높음 | 높음 |
| 진짜 선행관계 vs 공통 원인 반응을 어떻게 구분? | 높음 | 높음 |
| 임계점을 사전에 어떻게 정의하고 모니터링? | 중간 | 중간 |
| 정책 반응을 어떻게 모델에 통합? | 중간 | 높음 |

### 9.2 실무적 질문

| 질문 | 중요도 | 난이도 |
|------|--------|--------|
| TIER 1~5 각각에 어떤 가중치를 줄 것인가? | 높음 | 중간 |
| 각 선행지표의 Lead Time을 어떻게 검증? | 높음 | 중간 |
| 24/7 암호화폐를 전통 시장 분석에 어떻게 통합? | 중간 | 중간 |
| 신호 충돌 시 (파생상품 Risk-off, ETF Flow Risk-on) 어떻게 처리? | 중간 | 높음 |
| 새로운 자산군 (RWA, AI 토큰 등) 어떻게 통합? | 낮음 | 중간 |

### 9.3 데이터 질문

| 질문 | 중요도 | 난이도 |
|------|--------|--------|
| 이벤트 "중요도" 기준을 어떻게 정의? | 높음 | 중간 |
| 이벤트 후 안정화 기간을 어떻게 결정? | 중간 | 중간 |
| 다중 이벤트가 겹칠 때 어떻게 분리? | 중간 | 높음 |
| 무료 데이터로 시작 시 최적 조합은? | 중간 | 낮음 |

---

## 10. 구현 로드맵

### Phase 1: 데이터 인프라 (Week 1-2)

```
□ 무료 데이터 소스 연결
  ├── yfinance: 가격, 거래량
  ├── FRED API: 거시 지표
  ├── CoinGecko API: 암호화폐
  └── CBOE: VIX 데이터

□ 데이터 저장/갱신 파이프라인
  ├── 일간 자동 수집
  ├── 데이터 검증 로직
  └── 히스토리 구축 (2020~현재)
```

### Phase 2: 기초 분석 모듈 (Week 3-4)

```
□ Critical Path 기본 지표 계산
  ├── HY Spread, Term Spread
  ├── VIX Term Structure
  ├── 섹터 비율 (XLY/XLP, Cu/Au 등)
  └── 암호화폐 지표 (BTC Dominance 등)

□ 상관관계 분석
  ├── Rolling correlation 계산
  ├── Correlation regime 탐지
  └── Cross-asset 상관 매트릭스
```

### Phase 3: 이벤트 시스템 (Week 5-6)

```
□ Structural Break 탐지
  ├── Chow Test / CUSUM 구현
  ├── 변동성 급변 탐지
  └── 수동 이벤트 태깅 시스템

□ 이벤트 기반 분석
  ├── Pre/Post 이벤트 분리
  ├── 이벤트 유형별 분류
  └── 이벤트 영향 측정
```

### Phase 4: 예측 시스템 (Week 7-8)

```
□ 예측 모델 설계
  ├── 3-Class 분류 (상승/보합/하락)
  ├── 확률 임계값 기반 필터
  └── Regime별 조건부 모델

□ 평가 시스템
  ├── 클래스별 Precision/Recall
  ├── 경제적 가치 메트릭
  └── 백테스팅 (이벤트 기반)
```

### Phase 5: 통합 및 대시보드 (Week 9-10)

```
□ 통합 파이프라인
  ├── 5-Tier 지표 통합
  ├── 신호 종합 로직
  └── Alert 시스템

□ 시각화/대시보드
  ├── Critical Path 모니터링
  ├── Regime 상태 표시
  └── 예측 결과 표시
```

---

## 부록: 핵심 용어 정리

| 용어 | 정의 |
|------|------|
| Critical Path | 시장 선행/후행 관계의 핵심 경로 |
| Structural Break | 시장 구조가 근본적으로 변화하는 시점 |
| Regime | 시장의 상태 (Bull/Bear/Crisis/Normal 등) |
| Simultaneity | 두 변수가 서로 동시에 영향을 주는 문제 |
| Lead Time | 선행지표가 후행지표보다 앞서는 시간 |
| Whitebox | 결과의 원인을 설명할 수 있는 투명한 모델 |
| ETF Flow | ETF로의 자금 유입/유출 |
| GEX (Gamma Exposure) | 시장 전체의 옵션 감마 노출 |
| Skew | OTM Put과 OTM Call의 내재 변동성 차이 |

---

*이 문서는 Market Intelligence System v3.0의 개념 설계 논의를 정리한 것입니다.*
*코드 구현 전 이론적 토대를 확립하기 위한 목적으로 작성되었습니다.*
